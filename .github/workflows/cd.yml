name: Continuous Delivery (CD)

on:
  workflow_run:
    workflows: ["Continuous Integration (CI)"] # ğŸ’¡ ci.yml ã® name ã¨å®Œå…¨ã«ä¸€è‡´ã•ã›ã‚‹
    types: [completed]
    branches: [main]

jobs:
  # ğŸ’¡ workflow_run ã‚’ä½¿ã†å ´åˆã€needs: ci ã¯ä¸è¦ã§ã™
  deploy:
    runs-on: ubuntu-latest
    
    # workflow_run ã‚’ä½¿ã£ã¦ãƒˆãƒªã‚¬ãƒ¼ã•ã‚ŒãŸå ´åˆã€æˆåŠŸã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚¹ãƒ†ãƒƒãƒ—ã‚’è¿½åŠ 
    if: ${{ github.event.workflow_run.conclusion == 'success' }}

    env:
      CLOUDFLARE_API_TOKEN: ${{ secrets.CLOUDFLARE_API_TOKEN }}
      CLOUDFLARE_ACCOUNT_ID: ${{ secrets.CLOUDFLARE_ACCOUNT_ID }}

    steps:
      - name: â¬‡ï¸ Checkout Repository
        # workflow_run ã®å ´åˆã¯ã€ãƒªãƒã‚¸ãƒˆãƒªã®å±¥æ­´ã‚’å†åº¦ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
        uses: actions/checkout@v4
        with:
          ref: ${{ github.event.workflow_run.head_sha }} # CIãŒå®Ÿè¡Œã•ã‚ŒãŸã‚³ãƒŸãƒƒãƒˆã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ

      - name: âš™ï¸ Setup Node.js
        # ... å¾Œç•¥ ...